<!DOCTYPE html>
<html lang="is">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Afm√¶li mitt</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=DM+Mono:wght@300;400;500&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

:root {
  --bg: #0d0f14;
  --surface: #161a22;
  --surface-hover: #202735;
  --text: #f9fafb;
  --text-muted: #a8b1c2;
  --border: #2a3242;
  --border-light: #3a465c;
  --primary: #d4af37;
  --primary-text: #0a0b10;
  --secondary: #6b7280;
  --accent: #f5d77a;
  --danger: #e05252;
  --success: #2fb36d;
  --warning: #d99b24;
  --shadow: rgba(0, 0, 0, 0.52);
  --glow: rgba(212, 175, 55, 0.26);
  --gradient: linear-gradient(160deg, rgba(212, 175, 55, 0.16), rgba(20, 24, 35, 0.92));
  --overlay-surface: rgba(16, 20, 30, 0.88);
  --grid-line: rgba(245, 215, 122, 0.04);
  --party-string: rgba(255,255,255,0.18);
  --party-sparkle: rgba(255,255,255,0.75);
  --balloon-1: var(--accent);
  --balloon-2: var(--success);
  --balloon-3: #a78bfa;
  --balloon-4: var(--warning);
  --balloon-5: var(--danger);
  --balloon-6: #f472b6;

  /* Legacy aliases kept to avoid layout/flow changes in existing shell */
  --bg-dark: var(--bg);
  --bg-card: var(--surface);
  --bg-card-hover: var(--surface-hover);
  --text-primary: var(--text);
  --text-secondary: var(--text-muted);
  --accent-dim: color-mix(in srgb, var(--accent) 18%, transparent);
  --accent-glow: var(--glow);
  --green: var(--success);
  --green-dim: color-mix(in srgb, var(--success) 18%, transparent);
  --amber: var(--warning);
  --amber-dim: color-mix(in srgb, var(--warning) 18%, transparent);
  --red: var(--danger);
  --red-dim: color-mix(in srgb, var(--danger) 18%, transparent);
  --purple: #a78bfa;
  --purple-dim: color-mix(in srgb, #a78bfa 18%, transparent);
  --radius: 12px;
  --font-body: 'Outfit', sans-serif;
  --font-mono: 'DM Mono', monospace;
}

html { font-size: 16px; scroll-behavior: smooth; }
body { font-family: var(--font-body); background: var(--bg-dark); color: var(--text-primary); overflow-x: hidden; }

.desktop-wrapper { display: none; }

@media (min-width: 769px) {
  .desktop-wrapper {
    display: flex;
    height: 100vh;
    overflow: hidden;
    background: var(--bg);
    background-image:
      radial-gradient(ellipse at 20% 50%, var(--grid-line) 0%, transparent 60%),
      radial-gradient(ellipse at 80% 50%, color-mix(in srgb, var(--success) 10%, transparent) 0%, transparent 60%);
    position: relative;
  }
  .desktop-wrapper::before {
    content: '';
    position: absolute;
    inset: 0;
    background-image:
      linear-gradient(var(--grid-line) 1px, transparent 1px),
      linear-gradient(90deg, var(--grid-line) 1px, transparent 1px);
    background-size: 60px 60px;
    pointer-events: none;
    mask-image: radial-gradient(ellipse at 50% 50%, black 30%, transparent 70%);
  }
  .desktop-story {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    padding: 3rem 3.5rem 2rem 5rem;
    max-width: 520px;
    position: relative;
    z-index: 1;
    overflow-y: auto;
  }
  .desktop-story .eyebrow {
    font-family: var(--font-mono);
    font-size: 0.72rem;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    color: var(--accent);
    margin-bottom: 1.2rem;
    opacity: 0; animation: fadeUp 0.6s ease forwards 0.2s;
  }
  .desktop-story h1 {
    font-size: 2.4rem;
    font-weight: 700;
    line-height: 1.15;
    margin-bottom: 1.5rem;
    opacity: 0; animation: fadeUp 0.6s ease forwards 0.4s;
  }
  .desktop-story h1 .highlight { color: var(--accent); }
  .desktop-story p {
    font-size: 1rem;
    line-height: 1.7;
    color: var(--text-secondary);
    opacity: 0; animation: fadeUp 0.6s ease forwards 0.6s;
  }

  .phone-wrapper {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 2rem;
  }
  .phone-frame {
    width: 390px;
    height: 844px;
    border-radius: 48px;
    border: 4px solid var(--border-light);
    background: var(--bg-dark);
    overflow: hidden;
    position: relative;
    box-shadow: 0 0 60px var(--glow), 0 0 120px var(--shadow);
  }
  .phone-frame::before {
    content: '';
    position: absolute;
    top: 0; left: 50%; transform: translateX(-50%);
    width: 160px; height: 32px;
    background: var(--surface);
    border-radius: 0 0 20px 20px;
    z-index: 10;
  }
  .phone-content {
    height: 100%;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
  }
  .phone-content::-webkit-scrollbar { width: 0; }

  .desktop-right {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    padding: 3rem 5rem 3rem 3.5rem;
    max-width: 520px;
    position: relative;
    z-index: 1;
  }

  .mobile-only { display: none !important; }
}

@media (max-width: 768px) {
  .desktop-wrapper { display: none !important; }
  .phone-content-mobile { display: block; }
}

.card {
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 1.25rem;
  transition: all 0.2s;
}
.card:hover { background: var(--bg-card-hover); border-color: var(--border-light); }

.kpi {
  display: flex;
  flex-direction: column;
  padding: 1rem 1.25rem;
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
}
.kpi-label { font-size: 0.75rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 0.5rem; }
.kpi-value { font-size: 1.75rem; font-weight: 700; font-family: var(--font-mono); }

.section-label {
  font-family: var(--font-mono);
  font-size: 0.7rem;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: var(--accent);
  margin-bottom: 0.8rem;
}

.expand-card { cursor: pointer; }
.expand-card .expand-content { max-height: 0; overflow: hidden; transition: max-height 0.4s ease; }
.expand-card.open .expand-content { max-height: 1200px; }
.expand-card .expand-indicator { transition: transform 0.3s; }
.expand-card.open .expand-indicator { transform: rotate(180deg); }

@keyframes fadeUp {
  from { opacity: 0; transform: translateY(16px); }
  to { opacity: 1; transform: translateY(0); }
}
.animate-on-scroll { opacity: 0; transform: translateY(20px); transition: all 0.6s ease; }
.animate-on-scroll.visible { opacity: 1; transform: translateY(0); }

.safe-top { padding-top: max(env(safe-area-inset-top), 12px); }
.safe-bottom { padding-bottom: max(env(safe-area-inset-bottom), 12px); }

.pill {
  display: inline-block;
  border: 1px solid var(--border-light);
  border-radius: 999px;
  padding: 0.2rem 0.6rem;
  font-size: 0.72rem;
  color: var(--text-secondary);
  margin-right: 0.35rem;
  margin-top: 0.35rem;
}

.btn {
  border: 1px solid var(--border-light);
  border-radius: 10px;
  padding: 0.55rem 0.8rem;
  background: color-mix(in srgb, var(--bg) 88%, #000 12%);
  color: var(--text-primary);
  font-size: 0.86rem;
  cursor: pointer;
  text-decoration: none;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-height: 44px;
}
.btn.primary { background: var(--accent-dim); border-color: var(--accent); }
.btn.success { background: var(--green-dim); border-color: var(--green); }
.btn.danger { background: var(--red-dim); border-color: var(--red); }
.btn:disabled { opacity: 0.55; cursor: not-allowed; }

.link-list { display: flex; flex-wrap: wrap; gap: 0.5rem; margin-top: 0.6rem; }
.todo-list { padding-left: 1.1rem; margin-top: 0.5rem; }
.todo-list li { margin-bottom: 0.42rem; }
.time-item { margin-bottom: 0.5rem; }
.time-item b { color: var(--accent); }
.muted { color: var(--text-secondary); }
.hero {
  margin: 1rem;
  padding: 1rem;
  border-radius: var(--radius);
  border: 1px solid var(--border);
  background: var(--gradient);
}
.hero-wrap { display: grid; grid-template-columns: 88px 1fr; gap: 0.9rem; align-items: center; }
.hero-photo {
  width: 88px;
  height: 88px;
  border-radius: 50%;
  border: 2px solid var(--accent);
  object-fit: cover;
  background: var(--surface-hover);
}
.hero-count { font-family: var(--font-mono); font-size: 0.9rem; color: var(--accent); margin-top: 0.25rem; }
.quiz-title { font-weight: 600; margin-bottom: 0.45rem; color: var(--text-primary); }
.quiz-option {
  display: block;
  width: 100%;
  margin-bottom: 0.45rem;
  text-align: left;
}
.quiz-meta { font-size: 0.78rem; color: var(--text-muted); margin-bottom: 0.5rem; }
.theme-chip { font-size: 0.78rem; padding: 0.4rem 0.65rem; border-radius: 999px; border: 1px solid var(--border-light); cursor: pointer; min-height: 44px; display: inline-flex; align-items: center; }
.theme-chip.active { border-color: var(--accent); color: var(--accent); box-shadow: 0 0 0 1px var(--accent-dim) inset; }
.party-layer { position: fixed; inset: 0; pointer-events: none; overflow: hidden; z-index: 3; }
.balloon {
  position: absolute;
  bottom: -120px;
  width: 24px;
  height: 30px;
  border-radius: 50% 50% 48% 48%;
  opacity: 0.65;
  animation: balloonRise linear infinite;
}
.balloon.b1 { background: var(--balloon-1); }
.balloon.b2 { background: var(--balloon-2); }
.balloon.b3 { background: var(--balloon-3); }
.balloon.b4 { background: var(--balloon-4); }
.balloon.b5 { background: var(--balloon-5); }
.balloon.b6 { background: var(--balloon-6); }
.balloon::after {
  content: '';
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  top: 28px;
  width: 1px;
  height: 44px;
  background: var(--party-string);
}
.glitter {
  position: absolute;
  width: 4px;
  height: 4px;
  border-radius: 50%;
  background: var(--party-sparkle);
  animation: glitterTwinkle 3.8s ease-in-out infinite;
}
@keyframes balloonRise {
  from { transform: translateY(0) translateX(0) rotate(0deg); }
  to { transform: translateY(-120vh) translateX(28px) rotate(12deg); }
}
@keyframes glitterTwinkle {
  0%,100% { opacity: 0.15; transform: scale(0.6); }
  50% { opacity: 0.85; transform: scale(1.2); }
}
.flip-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 0.6rem; }
.flip-card { perspective: 900px; min-height: 120px; }
.flip-inner {
  position: relative;
  width: 100%;
  min-height: 120px;
  transform-style: preserve-3d;
  transition: transform 0.55s ease;
}
.flip-card.flipped .flip-inner { transform: rotateY(180deg); }
.flip-face {
  position: absolute;
  inset: 0;
  border-radius: 10px;
  border: 1px solid var(--border-light);
  background: color-mix(in srgb, var(--bg) 78%, transparent);
  padding: 0.7rem;
  backface-visibility: hidden;
}
.flip-face.back { transform: rotateY(180deg); background: var(--accent-dim); }
.photo-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 0.55rem; margin-top: 0.7rem; }
.photo-item { border-radius: 10px; overflow: hidden; border: 1px solid var(--border-light); background: color-mix(in srgb, var(--bg) 74%, transparent); }
.photo-item img { width: 100%; height: 110px; object-fit: cover; display: block; }
.photo-item div { padding: 0.4rem 0.5rem; font-size: 0.75rem; color: var(--text-secondary); }
.bottom-nav {
  position: fixed;
  left: 50%;
  bottom: max(8px, env(safe-area-inset-bottom));
  transform: translateX(-50%);
  background: var(--overlay-surface);
  border: 1px solid var(--border-light);
  border-radius: 999px;
  padding: 0.35rem;
  display: flex;
  gap: 0.28rem;
  z-index: 25;
  backdrop-filter: blur(8px);
}
.nav-chip {
  border: 1px solid transparent;
  border-radius: 999px;
  padding: 0.33rem 0.56rem;
  font-size: 0.72rem;
  color: var(--text-secondary);
  background: transparent;
  cursor: pointer;
  min-height: 44px;
  display: inline-flex;
  align-items: center;
}
.nav-chip:hover { border-color: var(--border-light); color: var(--text-primary); }
</style>
</head>
<body>
<div class="party-layer" aria-hidden="true">
  <div class="balloon b1" style="left:8%;animation-duration:16s;"></div>
  <div class="balloon b2" style="left:18%;animation-duration:20s;"></div>
  <div class="balloon b3" style="left:34%;animation-duration:18s;"></div>
  <div class="balloon b4" style="left:56%;animation-duration:17s;"></div>
  <div class="balloon b5" style="left:76%;animation-duration:21s;"></div>
  <div class="balloon b6" style="left:90%;animation-duration:19s;"></div>
  <div class="glitter" style="left:9%;top:14%;animation-delay:0.2s;"></div>
  <div class="glitter" style="left:28%;top:36%;animation-delay:1.1s;"></div>
  <div class="glitter" style="left:47%;top:21%;animation-delay:0.7s;"></div>
  <div class="glitter" style="left:67%;top:31%;animation-delay:1.6s;"></div>
  <div class="glitter" style="left:82%;top:18%;animation-delay:0.4s;"></div>
</div>

<div class="desktop-wrapper">
  <div class="desktop-story">
    <div class="eyebrow">2076 PART√ùAPP</div>
    <h1>Afm√¶li mitt <span class="highlight">Omar 50</span></h1>
    <p>
      Fars√≠mafyrst part√Ωskipulag fyrir 19. j√∫n√≠ 2026. √ötliti√∞ heldur upprunalegu skeljarst√≠lnum,
      me√∞ hlutum fyrir bo√∞ssv√∂r, tengla, lei√∞ir og Omar 50 t√≠mal√≠nu innbl√°sna af B√≥k L√≠fsins og omar4.0.
    </p>
  </div>

  <div class="phone-wrapper">
    <div class="phone-frame">
      <div class="phone-content" id="phoneContent"></div>
    </div>
  </div>

  <div class="desktop-right"></div>
</div>

<div class="phone-content-mobile" id="appContent">
  <header class="safe-top" style="background: var(--bg-card); border-bottom: 1px solid var(--border); padding: 1rem 1.25rem;">
    <div class="section-label" data-i18n="mobile_hub">FARS√çMA VI√êBUR√êAMI√êJA</div>
    <h1 style="font-size: 1.5rem; font-weight: 700;" data-i18n="title">Afm√¶li mitt</h1>
    <p class="muted" style="margin-top:0.35rem; font-size:0.9rem;" data-i18n="subtitle">Part√Ωskipulag og bo√∞svarsferli fyrir 50 √°ra afm√¶li Omars.</p>
    <div style="margin-top:0.5rem;">
      <span class="theme-chip active" data-lang-select="is">IS</span>
      <span class="theme-chip" data-lang-select="en">EN</span>
    </div>
    <div style="margin-top:0.5rem;" data-theme-picker>
      <span class="theme-chip active" data-theme-select="bond">Bond</span>
      <span class="theme-chip" data-theme-select="deathBecomesHer">Death Becomes Her</span>
      <span class="theme-chip" data-theme-select="pinkPanther">Pink Panther</span>
      <span class="theme-chip" data-theme-select="retro80s">80s Retro</span>
    </div>
  </header>

  <section id="sec-home" class="hero animate-on-scroll">
    <div class="hero-wrap">
      <img class="hero-photo" src="/omar-birthday.jpg" alt="Birthday person photo" />
      <div>
        <div style="font-weight:700; font-size:1.1rem;">Omar ver√∞ur 50 √°ra</div>
        <div class="muted" style="font-size:0.86rem; margin-top:0.1rem;">19. j√∫n√≠ 2026</div>
        <div class="hero-count" data-countdown>Hle√∞ ni√∞urtalningu...</div>
      </div>
    </div>
  </section>

  <section style="padding: 0 1rem 1rem;">
    <div class="section-label" data-i18n="party_sections">PART√ùHLUTAR</div>

    <div id="sec-rsvp" class="card expand-card animate-on-scroll open" onclick="this.classList.toggle('open')" style="margin-bottom: 0.75rem;">
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <div>
          <div style="font-weight: 600;" data-i18n="rsvp_title">Svara bo√∞i + innskr√°ning</div>
          <div style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 0.25rem;" data-i18n="rsvp_sub">Skr√°√∞u √æig inn me√∞ SMS e√∞a Google og svara√∞u bo√∞inu</div>
        </div>
        <span class="expand-indicator" style="color: var(--text-muted);">‚ñº</span>
      </div>
      <div class="expand-content">
        <div style="padding-top: 1rem; font-size: 0.9rem; color: var(--text-secondary); line-height: 1.6;">
          <div class="link-list" style="margin-top:0; margin-bottom:0.7rem;">
            <button class="btn" data-auth="sms" data-i18n="auth_sms">Halda √°fram me√∞ SMS</button>
            <button class="btn" data-auth="google" data-i18n="auth_google">Halda √°fram me√∞ Google</button>
          </div>
          <div data-auth-state class="muted" style="font-size:0.82rem;" data-i18n="not_signed">Ekki innskr√°√∞/ur.</div>
          <div class="link-list" style="margin-top:0.7rem;">
            <button class="btn success" data-rsvp="yes" data-i18n="yes_btn" disabled>J√°, √©g m√¶ti</button>
            <button class="btn danger" data-rsvp="no" data-i18n="no_btn" disabled>Nei, kemst ekki</button>
          </div>
          <div data-status class="muted" style="margin-top:0.6rem; font-size:0.82rem;" data-i18n="sign_in_first">Skr√°√∞u √æig inn fyrst til a√∞ svara bo√∞inu.</div>
        </div>
      </div>
    </div>

    <div id="sec-links" class="card expand-card animate-on-scroll" onclick="this.classList.toggle('open')" style="margin-bottom: 0.75rem;">
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <div>
          <div style="font-weight: 600;">Tenglar, lei√∞ir og verkefnalisti</div>
          <div style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 0.25rem;">Allt sem gestir √æurfa fyrir part√Ωdag</div>
        </div>
        <span class="expand-indicator" style="color: var(--text-muted);">‚ñº</span>
      </div>
      <div class="expand-content">
        <div style="padding-top: 1rem; font-size: 0.9rem; color: var(--text-secondary); line-height: 1.6;">
          <div class="link-list">
            <a class="btn primary" href="https://facebook.com/events" target="_blank" rel="noreferrer">Facebook-vi√∞bur√∞ur</a>
            <a class="btn" href="https://maps.google.com/?q=Reykjav%C3%ADk" target="_blank" rel="noreferrer">Lei√∞arl√Ωsing</a>
          </div>
          <div style="margin-top:0.8rem;" class="muted">
            <div class="time-item"><b>18:00</b> Hur√∞ar opna + velkomin drykkur</div>
            <div class="time-item"><b>19:30</b> S√∂gubrot + sk√°lr√¶√∞u</div>
            <div class="time-item"><b>21:00</b> T√≥nlist + dansg√≥lf</div>
          </div>
          <ul class="todo-list">
            <li>Sta√∞festu n√°kv√¶mt sta√∞fang og b√≠last√¶√∞auppl√Ωsingar.</li>
            <li>Lj√∫ktu vi√∞ matar- og k√∂kumagn √∫t fr√° bo√∞ssv√∂rum.</li>
            <li>Birtu lokaskilabo√∞ til gesta 72 klst. fyrir vi√∞bur√∞.</li>
          </ul>
          <span class="pill">Fars√≠mi</span>
          <span class="pill">2076 st√≠ll</span>
        </div>
      </div>
    </div>

    <div class="card expand-card animate-on-scroll" onclick="this.classList.toggle('open')" style="margin-bottom: 0.75rem;">
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <div>
          <div style="font-weight: 600;">Flj√≥tlegar sta√∞reyndir</div>
          <div style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 0.25rem;">Smelltu til a√∞ sn√∫a</div>
        </div>
        <span class="expand-indicator" style="color: var(--text-muted);">‚ñº</span>
      </div>
      <div class="expand-content">
        <div style="padding-top: 1rem;">
          <div class="flip-grid">
            <div class="flip-card" data-flip-card>
              <div class="flip-inner">
                <div class="flip-face front">1999<br><small class="muted">Ferill tekur √≥v√¶nta beygju</small></div>
                <div class="flip-face back">Eitt s√≠mtal fr√° T√∂lvun breytti √∂llu. R√°√∞ning af √∂rl√∂gum, ekki starfsmannag√°tt.</div>
              </div>
            </div>
            <div class="flip-card" data-flip-card>
              <div class="flip-inner">
                <div class="flip-face front">2017<br><small class="muted">omar4.0 h√≥fst</small></div>
                <div class="flip-face back">√Årlegar uppf√¶rslur h√≥fust. F√≥lk getur l√≠ka sent √∫t breytingaskr√°r.</div>
              </div>
            </div>
            <div class="flip-card" data-flip-card>
              <div class="flip-inner">
                <div class="flip-face front">2026<br><small class="muted">v50.0 h√°t√≠√∞</small></div>
                <div class="flip-face back">Engin bakf√¶rsla. Part√Ωherting er komin √≠ framlei√∞slu.</div>
              </div>
            </div>
            <div class="flip-card" data-flip-card>
              <div class="flip-inner">
                <div class="flip-face front">Budapest<br><small class="muted">go√∞sagnahamur</small></div>
                <div class="flip-face back">40 bj√≥rar, 4 dagar og samt n√≥g minni fyrir √æetta part√Ω.</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="sec-quiz" class="card expand-card animate-on-scroll" onclick="this.classList.toggle('open')" style="margin-bottom: 0.75rem;">
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <div>
          <div style="font-weight: 600;">S√∂gumerki Omar 50</div>
          <div style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 0.25rem;">S√≥tt √∫r n√∫verandi 50 √°ra Omar efni</div>
        </div>
        <span class="expand-indicator" style="color: var(--text-muted);">‚ñº</span>
      </div>
      <div class="expand-content">
        <div style="padding-top: 1rem; font-size: 0.9rem; color: var(--text-secondary); line-height: 1.6;">
          <div class="time-item"><b>1999</b> S√≠mtali√∞ fr√° T√∂lvun breytti ferlinum.</div>
          <div class="time-item"><b>2017</b> omar4.0 h√≥f √°rlegar markvissar uppf√¶rslur.</div>
          <div class="time-item"><b>2026</b> v50.0 h√°t√≠√∞: people, gratitude, and memories.</div>
        </div>
      </div>
    </div>

    <div class="card expand-card animate-on-scroll" onclick="this.classList.toggle('open')" style="margin-bottom: 0.75rem;">
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <div>
          <div style="font-weight: 600;">Omar 50 spurningaleikur</div>
          <div style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 0.25rem;">Allar spurningar s√≥ttar √∫r √∫tdr√¶gum spurningagrunni</div>
        </div>
        <span class="expand-indicator" style="color: var(--text-muted);">‚ñº</span>
      </div>
      <div class="expand-content">
        <div style="padding-top: 1rem; font-size: 0.9rem; color: var(--text-secondary); line-height: 1.6;">
          <div class="quiz-meta">
            <span data-quiz-progress>Spurning 0 / 0</span> ‚Ä¢ <span data-quiz-score>Stig 0</span>
          </div>
          <div data-quiz-question class="quiz-title">√ùttu √° ‚ÄûByrja leik‚Äú til a√∞ hefja.</div>
          <div data-quiz-options></div>
          <div data-quiz-result class="muted" style="margin-top:0.45rem; min-height: 1.6rem;"></div>
          <div class="link-list" style="margin-top:0.6rem;">
            <button class="btn primary" data-quiz-action="start">Byrja leik</button>
            <button class="btn" data-quiz-action="next" disabled>N√¶sta spurning</button>
          </div>
          <div class="link-list" style="margin-top:0.6rem;">
            <button class="btn" data-quiz-admin="login">Opna stj√≥rnandaa√∞gang</button>
            <button class="btn" data-quiz-admin="add" disabled>B√¶ta vi√∞ spurningu</button>
            <button class="btn danger" data-quiz-admin="delete" disabled>Ey√∞a spurningu</button>
          </div>
        </div>
      </div>
    </div>

    <div id="sec-hosting" class="card expand-card animate-on-scroll" onclick="this.classList.toggle('open')" style="margin-bottom: 0.75rem;">
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <div>
          <div style="font-weight: 600;">H√Ωsisl√≥√∞ + myllumerki</div>
          <div style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 0.25rem;">`mybirthday.myx.is/omars50` og myllumerkjami√∞u√∞ lei√∞aval.</div>
        </div>
        <span class="expand-indicator" style="color: var(--text-muted);">‚ñº</span>
      </div>
      <div class="expand-content">
        <div style="padding-top: 1rem;">
          <div class="muted">N√∫verandi sl√≥√∞: <b data-current-slug>omars50</b></div>
          <div class="muted" style="margin-top:0.2rem;">Instagram myllumerki: <a data-hashtag-link href="#" target="_blank" class="btn" style="padding:0.25rem 0.45rem;">#omars50</a></div>
          <div class="link-list" style="margin-top:0.6rem;">
            <button class="btn" data-hosting-action="signup">B√∫a til n√Ωja h√Ωsta part√Ωs√≠√∞u</button>
          </div>
        </div>
      </div>
    </div>

    <div id="sec-photo" class="card expand-card animate-on-scroll" onclick="this.classList.toggle('open')" style="margin-bottom: 0.75rem;">
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <div>
          <div style="font-weight: 600;">Myndaveggur</div>
          <div style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 0.25rem;">Instagram myllumerkjaveggur + myndir valdar af gestgjafa.</div>
        </div>
        <span class="expand-indicator" style="color: var(--text-muted);">‚ñº</span>
      </div>
      <div class="expand-content">
        <div style="padding-top: 1rem;">
          <div class="link-list" style="margin-top:0;">
            <a class="btn primary" data-instagram-tag target="_blank" rel="noreferrer">Opna Instagram merki</a>
            <button class="btn" data-photo-action="add" disabled>B√¶ta vi√∞ mynd (gestgjafi)</button>
          </div>
          <div data-photo-status class="muted" style="margin-top:0.5rem;">Hle√∞ myndavegg...</div>
          <div class="photo-grid" data-photo-grid></div>
        </div>
      </div>
    </div>

    <div id="sec-host" class="card expand-card animate-on-scroll" onclick="this.classList.toggle('open')" style="margin-bottom: 0.75rem;">
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <div>
          <div style="font-weight: 600;">Stj√≥rnbor√∞ gestgjafa</div>
          <div style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 0.25rem;">Yfirlit gesta, greining spurningaleiks og n√Ωleg sv√∂r.</div>
        </div>
        <span class="expand-indicator" style="color: var(--text-muted);">‚ñº</span>
      </div>
      <div class="expand-content">
        <div style="padding-top: 1rem;">
          <div class="link-list" style="margin-top:0;">
            <button class="btn" data-admin-action="login">Innskr√°ning gestgjafa</button>
            <button class="btn primary" data-admin-action="refresh" disabled>Uppf√¶ra yfirlit</button>
          </div>
          <div data-admin-status class="muted" style="margin-top:0.5rem;">Gestgjafahamur er l√¶stur.</div>
          <div data-admin-overview class="muted" style="margin-top:0.7rem; font-size:0.86rem;"></div>
        </div>
      </div>
    </div>
  </section>

  <section style="padding: 0 1rem 1rem; display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem;">
    <div class="kpi">
      <div class="kpi-label">Vi√∞bur√∞ardagur</div>
      <div class="kpi-value" style="color: var(--accent);">19 JUN</div>
    </div>
    <div class="kpi">
      <div class="kpi-label">Sta√∞setning</div>
      <div class="kpi-value" style="color: var(--green);">Reykjav√≠k</div>
    </div>
    <div class="kpi">
      <div class="kpi-label">M√¶tir</div>
      <div class="kpi-value" style="color: var(--amber);" data-yes-count>0</div>
    </div>
    <div class="kpi">
      <div class="kpi-label">Not M√¶tir</div>
      <div class="kpi-value" style="color: var(--purple);" data-no-count>0</div>
    </div>
  </section>

  <footer class="safe-bottom" style="text-align: center; padding: 2rem 1rem; color: var(--text-muted); font-size: 0.8rem;">
    Afm√¶li mitt ‚Ä¢ Omar 50 ‚Ä¢ 19. j√∫n√≠ 2026
  </footer>

  <nav class="bottom-nav">
    <button class="nav-chip" data-jump="sec-home" data-i18n="nav_home">Heim</button>
    <button class="nav-chip" data-jump="sec-rsvp" data-i18n="nav_rsvp">RSVP</button>
    <button class="nav-chip" data-jump="sec-links" data-i18n="nav_plan">Dagskr√°</button>
    <button class="nav-chip" data-jump="sec-quiz" data-i18n="nav_quiz">Spurningar</button>
    <button class="nav-chip" data-jump="sec-photo" data-i18n="nav_photos">Myndir</button>
    <button class="nav-chip" data-jump="sec-host" data-i18n="nav_host">Gestgjafi</button>
  </nav>
</div>

<script>
function initInteractions(root) {
  const state = { method: null, contact: null, name: null };
  const quizState = { questions: [], index: -1, score: 0, active: false, adminPassword: null };

  const authState = root.querySelector('[data-auth-state]');
  const statusEl = root.querySelector('[data-status]');
  const yesBtn = root.querySelector('[data-rsvp="yes"]');
  const noBtn = root.querySelector('[data-rsvp="no"]');
  const quizProgress = root.querySelector('[data-quiz-progress]');
  const quizScore = root.querySelector('[data-quiz-score]');
  const quizQuestion = root.querySelector('[data-quiz-question]');
  const quizOptions = root.querySelector('[data-quiz-options]');
  const quizResult = root.querySelector('[data-quiz-result]');
  const quizStartBtn = root.querySelector('[data-quiz-action="start"]');
  const quizNextBtn = root.querySelector('[data-quiz-action="next"]');
  const quizAdminLoginBtn = root.querySelector('[data-quiz-admin="login"]');
  const quizAdminAddBtn = root.querySelector('[data-quiz-admin="add"]');
  const quizAdminDeleteBtn = root.querySelector('[data-quiz-admin="delete"]');
  const adminStatus = root.querySelector('[data-admin-status]');
  const adminOverview = root.querySelector('[data-admin-overview]');
  const adminLoginBtn = root.querySelector('[data-admin-action="login"]');
  const adminRefreshBtn = root.querySelector('[data-admin-action="refresh"]');
  const currentSlugLabel = root.querySelector('[data-current-slug]');
  const hashtagLink = root.querySelector('[data-hashtag-link]');
  const instagramTagLink = root.querySelector('[data-instagram-tag]');
  const hostingSignupBtn = root.querySelector('[data-hosting-action="signup"]');
  const photoStatus = root.querySelector('[data-photo-status]');
  const photoGrid = root.querySelector('[data-photo-grid]');
  const photoAddBtn = root.querySelector('[data-photo-action="add"]');
  const currentSlug = (window.__APP_SLUG__ || location.pathname.split('/').filter(Boolean)[0] || 'omars50').toLowerCase();

  root.querySelectorAll('button, a.btn').forEach((el) => {
    el.addEventListener('click', (ev) => ev.stopPropagation());
  });
  root.querySelectorAll('[data-flip-card]').forEach((el) => {
    el.addEventListener('click', (ev) => {
      ev.stopPropagation();
      el.classList.toggle('flipped');
    });
  });
  root.querySelectorAll('[data-jump]').forEach((el) => {
    el.addEventListener('click', (ev) => {
      ev.stopPropagation();
      const id = el.getAttribute('data-jump');
      if (!id) return;
      const target = root.querySelector('#' + id);
      if (!target) return;
      if (root.id === 'phoneContent') {
        root.scrollTo({ top: target.offsetTop - 10, behavior: 'smooth' });
      } else {
        target.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
    });
  });

  if (currentSlugLabel) currentSlugLabel.textContent = currentSlug;

  function setSignedIn(method, contact, name) {
    state.method = method;
    state.contact = contact;
    state.name = name;
    authState.textContent = 'Innskr√°√∞/ur me√∞ ' + method.toUpperCase() + ' sem ' + contact;
    yesBtn.disabled = false;
    noBtn.disabled = false;
    statusEl.textContent = 'Tilb√∫i√∞ a√∞ svara bo√∞i.';
  }

  async function refreshStats() {
    try {
      const res = await fetch('/api/rsvp/stats');
      const data = await res.json();
      document.querySelectorAll('[data-yes-count]').forEach((el) => { el.textContent = String(data.attendingYes ?? 0); });
      document.querySelectorAll('[data-no-count]').forEach((el) => { el.textContent = String(data.attendingNo ?? 0); });
    } catch {
      document.querySelectorAll('[data-yes-count]').forEach((el) => { el.textContent = '?'; });
      document.querySelectorAll('[data-no-count]').forEach((el) => { el.textContent = '?'; });
    }
  }

  async function submitRsvp(attending) {
    if (!state.contact || !state.method) {
      statusEl.textContent = 'Skr√°√∞u √æig inn fyrst.';
      return;
    }

    const partySize = Number(prompt('Hversu margir eru √≠ h√≥pnum √æ√≠num me√∞ √æ√©r?', '1') || '1');
    const plusOne = prompt('Nafn aukagests (valfrj√°lst):', '') || '';
    const dietary = prompt('Matar√≥skir (valfrj√°lst):', '') || '';
    const note = prompt('Skilabo√∞ til Omars (valfrj√°lst):', '') || '';

    statusEl.textContent = 'Sendi bo√∞ssvar...';
    try {
      const res = await fetch('/api/rsvp', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          attending,
          method: state.method,
          contact: state.contact,
          name: state.name || 'Gestur',
          partySize: Number.isFinite(partySize) ? partySize : 1,
          plusOne,
          dietary,
          note,
        })
      });
      const data = await res.json();
      if (!res.ok) throw new Error(data.error || 'Mist√≥kst a√∞ vista bo√∞ssvar');
      statusEl.textContent = attending
        ? 'Bo√∞ssvar vista√∞: m√¶tir.'
        : 'Bo√∞ssvar vista√∞: kemst ekki.';
      await refreshStats();
    } catch (err) {
      statusEl.textContent = 'Villa: ' + err.message;
    }
  }

  function renderQuizQuestion() {
    const q = quizState.questions[quizState.index];
    if (!q) return;
    quizProgress.textContent = 'Spurning ' + (quizState.index + 1) + ' / ' + quizState.questions.length;
    quizScore.textContent = 'Stig ' + quizState.score;
    quizQuestion.textContent = q.cat + ' (' + q.yr + '): ' + q.q;
    quizResult.textContent = '';
    quizOptions.innerHTML = '';
    q.opts.forEach((opt, idx) => {
      const btn = document.createElement('button');
      btn.className = 'btn quiz-option';
      btn.type = 'button';
      btn.textContent = String.fromCharCode(65 + idx) + '. ' + opt;
      btn.addEventListener('click', async (ev) => {
        ev.stopPropagation();
        if (!quizState.active) return;
        quizState.active = false;
        const res = await fetch('/api/quiz/answer', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            id: q.id,
            choice: idx,
            playerId: state.contact || 'nafnlaus',
            playerName: state.name || 'Gestur',
          })
        });
        const data = await res.json();
        if (data.correct) {
          quizState.score += 1;
          quizResult.textContent = 'R√©tt svar! ' + data.explanation;
        } else {
          quizResult.textContent = 'Rangt svar. ' + data.explanation;
        }
        quizScore.textContent = 'Stig ' + quizState.score;
        quizNextBtn.disabled = false;
        Array.from(quizOptions.querySelectorAll('button')).forEach((b) => { b.disabled = true; });
      });
      quizOptions.appendChild(btn);
    });
  }

  async function startQuiz(ev) {
    ev.stopPropagation();
    quizStartBtn.disabled = true;
    quizResult.textContent = 'Hle√∞ inn spurningum...';
    try {
      const res = await fetch('/api/quiz/questions');
      const data = await res.json();
      quizState.questions = data.questions || [];
      quizState.index = 0;
      quizState.score = 0;
      quizState.active = true;
      quizNextBtn.disabled = true;
      renderQuizQuestion();
    } catch {
      quizResult.textContent = 'Gat ekki hla√∞i√∞ spurningaleik.';
    } finally {
      quizStartBtn.disabled = false;
    }
  }

  function nextQuizQuestion(ev) {
    ev.stopPropagation();
    if (!quizState.questions.length) return;
    quizState.index += 1;
    if (quizState.index >= quizState.questions.length) {
      quizQuestion.textContent = 'Leik loki√∞.';
      quizOptions.innerHTML = '';
      quizResult.textContent = 'Lokastig: ' + quizState.score + ' / ' + quizState.questions.length;
      quizProgress.textContent = 'Spurning ' + quizState.questions.length + ' / ' + quizState.questions.length;
      quizNextBtn.disabled = true;
      quizState.active = false;
      return;
    }
    quizState.active = true;
    quizNextBtn.disabled = true;
    renderQuizQuestion();
  }

  function adminHeaders() {
    return {
      'Content-Type': 'application/json',
      'x-admin-password': quizState.adminPassword || ''
    };
  }

  function adminLogin(ev) {
    ev.stopPropagation();
    const pass = prompt('Lykilor√∞ stj√≥rnanda:');
    if (!pass) return;
    quizState.adminPassword = pass;
    quizAdminAddBtn.disabled = false;
    quizAdminDeleteBtn.disabled = false;
    if (adminRefreshBtn) adminRefreshBtn.disabled = false;
    quizResult.textContent = 'Stj√≥rnandahamur virkur.';
    if (adminStatus) adminStatus.textContent = 'Gestgjafahamur virkur.';
  }

  async function refreshAdminOverview(ev) {
    if (ev) ev.stopPropagation();
    if (!quizState.adminPassword || !adminOverview || !adminStatus) return;
    adminStatus.textContent = 'Hle√∞ yfirliti gestgjafa...';
    try {
      const res = await fetch('/api/admin/overview', { headers: { 'x-admin-password': quizState.adminPassword } });
      const data = await res.json();
      if (!res.ok) throw new Error(data.error || 'Mist√≥kst a√∞ hla√∞a yfirlit');
      const attendees = data.attendees || {};
      const quiz = data.quiz || {};
      const recent = (quiz.recentAnswers || []).slice(0, 8).map((r) =>
        (r.playerName || 'Gestur') + ' -> Q' + r.questionId + ' ' + (r.correct ? '‚úÖ' : '‚ùå')
      );
      adminOverview.innerHTML = [
        '<b>Gestir:</b> ' + (attendees.attending ?? 0) + ' j√°, ' + (attendees.notM√¶tir ?? 0) + ' nei, heildarfj√∂ldi: ' + (attendees.totalHeads ?? 0),
        '<br><b>Part√Ωsta√∞a:</b> ' + (attendees.humor || 'Dansg√≥lf √≥sta√∞fest.'),
        '<br><b>Spurningaleikur:</b> ' + (quiz.totalAnswers ?? 0) + ' sv√∂r, n√°kv√¶mni ' + Math.round((quiz.overallAccuracy || 0) * 100) + '%',
        '<br><b>Erfi√∞asta spurning:</b> ' + (quiz.hardestQuestionId ?? 'ekki tilt√¶kt'),
        '<br><b>N√Ωleg sv√∂r:</b> ' + (recent.length ? recent.join(' ‚Ä¢ ') : 'Engin enn')
      ].join('');
      adminStatus.textContent = 'Yfirlit gestgjafa uppf√¶rt.';
    } catch (err) {
      adminStatus.textContent = 'Mist√≥kst a√∞ s√¶kja yfirlit gestgjafa: ' + err.message;
    }
  }

  function updateHashtagLinks(tag) {
    const clean = (tag || currentSlug).replace(/^#/, '');
    const url = 'https://www.instagram.com/explore/tags/' + encodeURIComponent(clean) + '/';
    if (hashtagLink) {
      hashtagLink.textContent = '#' + clean;
      hashtagLink.setAttribute('href', url);
    }
    if (instagramTagLink) instagramTagLink.setAttribute('href', url);
  }

  async function loadPhotoWall() {
    if (!photoGrid || !photoStatus) return;
    photoStatus.textContent = 'Hle√∞ inn myndavegg...';
    try {
      const res = await fetch('/api/photowall?slug=' + encodeURIComponent(currentSlug));
      const data = await res.json();
      if (!res.ok) throw new Error(data.error || 'Mist√≥kst a√∞ hla√∞a myndavegg');
      updateHashtagLinks(data.hashtag || currentSlug);
      const items = data.items || [];
      if (!items.length) {
        photoGrid.innerHTML = '';
        photoStatus.textContent = 'Engar myndir enn. B√¶ttu vi√∞ √≠ gestgjafaham e√∞a nota√∞u #' + (data.hashtag || currentSlug);
        return;
      }
      photoStatus.textContent = items.length + ' myndir s√≥ttar.';
      photoGrid.innerHTML = items.slice(0, 24).map((item) => (
        '<div class="photo-item">' +
          '<img src="' + item.imageUrl + '" alt="Mynd √° myndavegg" loading="lazy" />' +
          '<div>' + (item.caption || 'Part√Ωminning') + '</div>' +
        '</div>'
      )).join('');
    } catch (err) {
      photoStatus.textContent = 'Myndaveggur br√°st: ' + err.message;
    }
  }

  async function hostingSignup(ev) {
    ev.stopPropagation();
    const hashtag = prompt('Hashtag fyrir sl√≥√∞ (d√¶mi: #omars50):', '#' + currentSlug);
    if (!hashtag) return;
    const instagramHandle = prompt('Instagram notandi (valfrj√°lst, √°n @):', '');
    const title = prompt('Heiti vi√∞bur√∞ar:', "It's My Birthday");
    const owner = prompt('Eigandi (valfrj√°lst):', '');
    try {
      const res = await fetch('/api/hosting/signup', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ hashtag, instagramHandle, title, owner })
      });
      const data = await res.json();
      if (!res.ok) throw new Error(data.error || 'Mist√≥kst a√∞ b√∫a til h√Ωsingu');
      alert('N√Ω part√Ωs√≠√∞a b√∫in til: ' + data.url + '\\nHashtag: #' + data.tenant.hashtag);
    } catch (err) {
      alert('H√Ωsing mist√≥kst: ' + err.message);
    }
  }

  async function addPhotoItem(ev) {
    ev.stopPropagation();
    if (!quizState.adminPassword) return;
    const imageUrl = prompt('Sl√≥√∞ √° mynd:');
    if (!imageUrl) return;
    const caption = prompt('Texti (valfrj√°lst):', '') || '';
    const sourceUrl = prompt('Instagram/sl√≥√∞ uppruna (valfrj√°lst):', '') || '';
    try {
      const res = await fetch('/api/photowall/item', {
        method: 'POST',
        headers: adminHeaders(),
        body: JSON.stringify({ slug: currentSlug, imageUrl, caption, sourceUrl })
      });
      const data = await res.json();
      if (!res.ok) throw new Error(data.error || 'Mist√≥kst a√∞ b√¶ta vi√∞ mynd');
      if (photoStatus) photoStatus.textContent = 'Mynd b√¶tt vi√∞.';
      await loadPhotoWall();
    } catch (err) {
      if (photoStatus) photoStatus.textContent = 'Mynd mist√≥kst: ' + err.message;
    }
  }

  async function adminAddQuestion(ev) {
    ev.stopPropagation();
    if (!quizState.adminPassword) return;
    const yr = Number(prompt('√År (t.d. 2026):', '2026'));
    const cat = prompt('Flokkur (t.d. üéâ Part√Ω):', 'üéâ Part√Ω');
    const q = prompt('Spurningatexti:');
    const optsInput = prompt('Valkostir a√∞skildir me√∞ | (d√¶mi: A|B|C|D):');
    const ans = Number(prompt('R√©ttur valkostsv√≠sir (fr√° 0):', '0'));
    const exp = prompt('Sk√Ωring (valfrj√°lst):', 'B√¶tt vi√∞ af stj√≥rnanda.');
    const fun = prompt('Skemmtileg sta√∞reynd (valfrj√°lst):', 'S√©rsni√∞in spurning');
    if (!Number.isInteger(yr) || !cat || !q || !optsInput || !Number.isInteger(ans)) {
      quizResult.textContent = 'Stj√≥rnendavi√∞b√≥t h√¶tt vi√∞ e√∞a √≥gild innt√∂k.';
      return;
    }
    const opts = optsInput.split('|').map((x) => x.trim()).filter(Boolean);
    if (opts.length < 2) {
      quizResult.textContent = '√ûarf a√∞ minnsta kosti 2 valkosti.';
      return;
    }
    try {
      const res = await fetch('/api/quiz/admin/question', {
        method: 'POST',
        headers: adminHeaders(),
        body: JSON.stringify({ yr, cat, q, opts, ans, exp, fun })
      });
      const data = await res.json();
      if (!res.ok) throw new Error(data.error || 'Mist√≥kst a√∞ b√¶ta vi√∞ spurningu');
      quizResult.textContent = 'Spurningu b√¶tt vi√∞ me√∞ au√∞kenni ' + data.question.id + '.';
    } catch (err) {
      quizResult.textContent = 'Stj√≥rnendavi√∞b√≥t mist√≥kst: ' + err.message;
    }
  }

  async function adminDeleteQuestion(ev) {
    ev.stopPropagation();
    if (!quizState.adminPassword) return;
    const id = Number(prompt('Au√∞kenni spurningar til a√∞ ey√∞a (a√∞eins stj√≥rnendab√¶ttar):'));
    if (!Number.isInteger(id)) return;
    try {
      const res = await fetch('/api/quiz/admin/question?id=' + encodeURIComponent(String(id)), {
        method: 'DELETE',
        headers: { 'x-admin-password': quizState.adminPassword }
      });
      const data = await res.json();
      if (!res.ok) throw new Error(data.error || 'Mist√≥kst a√∞ ey√∞a spurningu');
      quizResult.textContent = 'Eyddi spurningu ' + data.id + '.';
    } catch (err) {
      quizResult.textContent = 'Ey√∞ing mist√≥kst: ' + err.message;
    }
  }

  const smsBtn = root.querySelector('[data-auth="sms"]');
  const googleBtn = root.querySelector('[data-auth="google"]');
  smsBtn.addEventListener('click', () => {
    const phone = prompt('Sl√°√∞u inn s√≠man√∫meri√∞ √æitt (fyrir SMS-innskr√°ningu):');
    if (!phone) return;
    const name = prompt('Your name:') || 'Gestur';
    setSignedIn('sms', phone.trim(), name.trim());
  });
  googleBtn.addEventListener('click', () => {
    const email = prompt('Sl√°√∞u inn Google netfangi√∞ √æitt:');
    if (!email) return;
    const name = prompt('Your name:') || 'Gestur';
    setSignedIn('google', email.trim().toLowerCase(), name.trim());
  });

  yesBtn.addEventListener('click', () => submitRsvp(true));
  noBtn.addEventListener('click', () => submitRsvp(false));
  if (quizStartBtn) quizStartBtn.addEventListener('click', startQuiz);
  if (quizNextBtn) quizNextBtn.addEventListener('click', nextQuizQuestion);
  if (quizAdminLoginBtn) quizAdminLoginBtn.addEventListener('click', adminLogin);
  if (quizAdminAddBtn) quizAdminAddBtn.addEventListener('click', adminAddQuestion);
  if (quizAdminDeleteBtn) quizAdminDeleteBtn.addEventListener('click', adminDeleteQuestion);
  if (adminLoginBtn) adminLoginBtn.addEventListener('click', adminLogin);
  if (adminRefreshBtn) adminRefreshBtn.addEventListener('click', refreshAdminOverview);

  refreshStats();
}

function initThemeSelector() {
  const root = document.documentElement;
  const storageKey = 'myx-family-theme';
  const defaultTheme = 'bond';
  const themes = {
    bond: {
      bg: '#0d0f14', surface: '#161a22', surfaceHover: '#202735', text: '#f9fafb', textMuted: '#a8b1c2',
      border: '#2a3242', borderLight: '#3a465c', primary: '#d4af37', primaryText: '#0a0b10', secondary: '#6b7280',
      accent: '#f5d77a', danger: '#e05252', success: '#2fb36d', warning: '#d99b24',
      shadow: 'rgba(0, 0, 0, 0.52)', glow: 'rgba(212, 175, 55, 0.26)',
      gradient: 'linear-gradient(160deg, rgba(212, 175, 55, 0.16), rgba(20, 24, 35, 0.92))'
    },
    deathBecomesHer: {
      bg: '#120b1b', surface: '#1d1230', surfaceHover: '#2a1a43', text: '#f9ecff', textMuted: '#c7addb',
      border: '#4a2f67', borderLight: '#6a4a8a', primary: '#d946ef', primaryText: '#13081d', secondary: '#7b638f',
      accent: '#22d3ee', danger: '#fb7185', success: '#34d399', warning: '#fbbf24',
      shadow: 'rgba(13, 6, 20, 0.56)', glow: 'rgba(217, 70, 239, 0.26)',
      gradient: 'linear-gradient(160deg, rgba(217, 70, 239, 0.18), rgba(18, 11, 27, 0.94))'
    },
    pinkPanther: {
      bg: '#130e16', surface: '#1e1725', surfaceHover: '#2a2035', text: '#fff4fb', textMuted: '#d9b6cd',
      border: '#5a3d54', borderLight: '#7a5472', primary: '#f472b6', primaryText: '#1b0f18', secondary: '#8e7085',
      accent: '#fb7185', danger: '#ef4444', success: '#22c55e', warning: '#f59e0b',
      shadow: 'rgba(18, 10, 16, 0.5)', glow: 'rgba(244, 114, 182, 0.24)',
      gradient: 'linear-gradient(160deg, rgba(244, 114, 182, 0.18), rgba(19, 14, 22, 0.94))'
    },
    retro80s: {
      bg: '#0b0d18', surface: '#151a2b', surfaceHover: '#1f2742', text: '#eef2ff', textMuted: '#aab5d9',
      border: '#30406b', borderLight: '#455a91', primary: '#22d3ee', primaryText: '#0a0f1a', secondary: '#6b7ba9',
      accent: '#a78bfa', danger: '#fb7185', success: '#34d399', warning: '#fbbf24',
      shadow: 'rgba(8, 10, 20, 0.58)', glow: 'rgba(34, 211, 238, 0.28)',
      gradient: 'linear-gradient(160deg, rgba(34, 211, 238, 0.18), rgba(167, 139, 250, 0.14), rgba(11, 13, 24, 0.96))'
    }
  };
  const saved = localStorage.getItem(storageKey) || defaultTheme;

  function apply(name) {
    const safe = themes[name] ? name : defaultTheme;
    const theme = themes[safe];
    root.style.setProperty('--bg', theme.bg);
    root.style.setProperty('--surface', theme.surface);
    root.style.setProperty('--surface-hover', theme.surfaceHover);
    root.style.setProperty('--text', theme.text);
    root.style.setProperty('--text-muted', theme.textMuted);
    root.style.setProperty('--border', theme.border);
    root.style.setProperty('--border-light', theme.borderLight);
    root.style.setProperty('--primary', theme.primary);
    root.style.setProperty('--primary-text', theme.primaryText);
    root.style.setProperty('--secondary', theme.secondary);
    root.style.setProperty('--accent', theme.accent);
    root.style.setProperty('--danger', theme.danger);
    root.style.setProperty('--success', theme.success);
    root.style.setProperty('--warning', theme.warning);
    root.style.setProperty('--shadow', theme.shadow);
    root.style.setProperty('--glow', theme.glow);
    root.style.setProperty('--gradient', theme.gradient);
    root.setAttribute('data-theme', safe);
    localStorage.setItem(storageKey, safe);
    document.querySelectorAll('[data-theme-select]').forEach((el) => {
      el.classList.toggle('active', el.getAttribute('data-theme-select') === safe);
    });
  }
  apply(saved);
  if (!window.__THEME_PICKER_BOUND__) {
    document.addEventListener('click', (event) => {
      const el = event.target && event.target.closest ? event.target.closest('[data-theme-select]') : null;
      if (!el) return;
      event.stopPropagation();
      apply(el.getAttribute('data-theme-select'));
    });
    window.__THEME_PICKER_BOUND__ = true;
  }
}

function startCountdown() {
  const target = new Date('2026-06-19T00:00:00');
  function tick() {
    const now = new Date();
    const diff = target.getTime() - now.getTime();
    const nodes = document.querySelectorAll('[data-countdown]');
    if (diff <= 0) {
      nodes.forEach((n) => { n.textContent = 'Til hamingju me√∞ afm√¶li√∞!'; });
      return;
    }
    const d = Math.floor(diff / 86400000);
    const h = Math.floor((diff % 86400000) / 3600000);
    const m = Math.floor((diff % 3600000) / 60000);
    const s = Math.floor((diff % 60000) / 1000);
    const text = d + 'd ' + h + 'h ' + m + 'm ' + s + 's √≠ part√Ω';
    nodes.forEach((n) => { n.textContent = text; });
  }
  tick();
  setInterval(tick, 1000);
}

initThemeSelector();

if (window.innerWidth > 768) {
  const src = document.getElementById('appContent');
  const dest = document.getElementById('phoneContent');
  if (src && dest) {
    dest.innerHTML = src.innerHTML;
    src.style.display = 'none';
    initInteractions(dest);
  }
} else {
  initInteractions(document.getElementById('appContent'));
}
startCountdown();

const observer = new IntersectionObserver((entries) => {
  entries.forEach((entry) => {
    if (entry.isIntersecting) {
      entry.target.classList.add('visible');
      observer.unobserve(entry.target);
    }
  });
}, { threshold: 0.1, rootMargin: '0px 0px -50px 0px' });

document.querySelectorAll('.animate-on-scroll').forEach((el) => observer.observe(el));

const phoneContent = document.getElementById('phoneContent');
if (phoneContent) {
  const phoneObserver = new IntersectionObserver((entries) => {
    entries.forEach((entry) => {
      if (entry.isIntersecting) {
        entry.target.classList.add('visible');
        phoneObserver.unobserve(entry.target);
      }
    });
  }, { threshold: 0.1, root: phoneContent });
  phoneContent.querySelectorAll('.animate-on-scroll').forEach((el) => phoneObserver.observe(el));
}
</script>
</body>
</html>
