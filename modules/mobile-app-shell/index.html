<!DOCTYPE html>
<html lang="is">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>It's My Birthday</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=DM+Mono:wght@300;400;500&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

:root {
  --bg-dark: #0a0e17;
  --bg-card: #111827;
  --bg-card-hover: #1a2332;
  --border: #1e293b;
  --border-light: #2a3a4e;
  --text-primary: #e2e8f0;
  --text-secondary: #94a3b8;
  --text-muted: #64748b;
  --accent: #22d3ee;
  --accent-dim: rgba(34,211,238,0.15);
  --accent-glow: rgba(34,211,238,0.08);
  --green: #34d399;
  --green-dim: rgba(52,211,153,0.15);
  --amber: #fbbf24;
  --amber-dim: rgba(251,191,36,0.15);
  --red: #f87171;
  --red-dim: rgba(248,113,113,0.15);
  --purple: #a78bfa;
  --purple-dim: rgba(167,139,250,0.15);
  --radius: 12px;
  --font-body: 'Outfit', sans-serif;
  --font-mono: 'DM Mono', monospace;
}

:root[data-theme="disco"] {
  --bg-dark: #13081d;
  --bg-card: #1d1230;
  --bg-card-hover: #261942;
  --accent: #f472b6;
  --accent-dim: rgba(244,114,182,0.18);
  --accent-glow: rgba(244,114,182,0.12);
  --border: #3a2758;
  --border-light: #4d3a6f;
}

:root[data-theme="sunset"] {
  --bg-dark: #1a0f09;
  --bg-card: #2a1a12;
  --bg-card-hover: #352118;
  --accent: #f59e0b;
  --accent-dim: rgba(245,158,11,0.2);
  --accent-glow: rgba(245,158,11,0.12);
  --border: #5b3b2b;
  --border-light: #7a5038;
}

html { font-size: 16px; scroll-behavior: smooth; }
body { font-family: var(--font-body); background: var(--bg-dark); color: var(--text-primary); overflow-x: hidden; }

.desktop-wrapper { display: none; }

@media (min-width: 769px) {
  .desktop-wrapper {
    display: flex;
    height: 100vh;
    overflow: hidden;
    background: #050810;
    background-image:
      radial-gradient(ellipse at 20% 50%, rgba(34,211,238,0.03) 0%, transparent 60%),
      radial-gradient(ellipse at 80% 50%, rgba(52,211,153,0.02) 0%, transparent 60%);
    position: relative;
  }
  .desktop-wrapper::before {
    content: '';
    position: absolute;
    inset: 0;
    background-image:
      linear-gradient(rgba(34,211,238,0.02) 1px, transparent 1px),
      linear-gradient(90deg, rgba(34,211,238,0.02) 1px, transparent 1px);
    background-size: 60px 60px;
    pointer-events: none;
    mask-image: radial-gradient(ellipse at 50% 50%, black 30%, transparent 70%);
  }
  .desktop-story {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    padding: 3rem 3.5rem 2rem 5rem;
    max-width: 520px;
    position: relative;
    z-index: 1;
    overflow-y: auto;
  }
  .desktop-story .eyebrow {
    font-family: var(--font-mono);
    font-size: 0.72rem;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    color: var(--accent);
    margin-bottom: 1.2rem;
    opacity: 0; animation: fadeUp 0.6s ease forwards 0.2s;
  }
  .desktop-story h1 {
    font-size: 2.4rem;
    font-weight: 700;
    line-height: 1.15;
    margin-bottom: 1.5rem;
    opacity: 0; animation: fadeUp 0.6s ease forwards 0.4s;
  }
  .desktop-story h1 .highlight { color: var(--accent); }
  .desktop-story p {
    font-size: 1rem;
    line-height: 1.7;
    color: var(--text-secondary);
    opacity: 0; animation: fadeUp 0.6s ease forwards 0.6s;
  }

  .phone-wrapper {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 2rem;
  }
  .phone-frame {
    width: 390px;
    height: 844px;
    border-radius: 48px;
    border: 4px solid #2a3a4e;
    background: var(--bg-dark);
    overflow: hidden;
    position: relative;
    box-shadow: 0 0 60px rgba(34,211,238,0.08), 0 0 120px rgba(0,0,0,0.4);
  }
  .phone-frame::before {
    content: '';
    position: absolute;
    top: 0; left: 50%; transform: translateX(-50%);
    width: 160px; height: 32px;
    background: #111;
    border-radius: 0 0 20px 20px;
    z-index: 10;
  }
  .phone-content {
    height: 100%;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
  }
  .phone-content::-webkit-scrollbar { width: 0; }

  .desktop-right {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    padding: 3rem 5rem 3rem 3.5rem;
    max-width: 520px;
    position: relative;
    z-index: 1;
  }

  .mobile-only { display: none !important; }
}

@media (max-width: 768px) {
  .desktop-wrapper { display: none !important; }
  .phone-content-mobile { display: block; }
}

.card {
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 1.25rem;
  transition: all 0.2s;
}
.card:hover { background: var(--bg-card-hover); border-color: var(--border-light); }

.kpi {
  display: flex;
  flex-direction: column;
  padding: 1rem 1.25rem;
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
}
.kpi-label { font-size: 0.75rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 0.5rem; }
.kpi-value { font-size: 1.75rem; font-weight: 700; font-family: var(--font-mono); }

.section-label {
  font-family: var(--font-mono);
  font-size: 0.7rem;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: var(--accent);
  margin-bottom: 0.8rem;
}

.expand-card { cursor: pointer; }
.expand-card .expand-content { max-height: 0; overflow: hidden; transition: max-height 0.4s ease; }
.expand-card.open .expand-content { max-height: 1200px; }
.expand-card .expand-indicator { transition: transform 0.3s; }
.expand-card.open .expand-indicator { transform: rotate(180deg); }

@keyframes fadeUp {
  from { opacity: 0; transform: translateY(16px); }
  to { opacity: 1; transform: translateY(0); }
}
.animate-on-scroll { opacity: 0; transform: translateY(20px); transition: all 0.6s ease; }
.animate-on-scroll.visible { opacity: 1; transform: translateY(0); }

.safe-top { padding-top: max(env(safe-area-inset-top), 12px); }
.safe-bottom { padding-bottom: max(env(safe-area-inset-bottom), 12px); }

.pill {
  display: inline-block;
  border: 1px solid var(--border-light);
  border-radius: 999px;
  padding: 0.2rem 0.6rem;
  font-size: 0.72rem;
  color: var(--text-secondary);
  margin-right: 0.35rem;
  margin-top: 0.35rem;
}

.btn {
  border: 1px solid var(--border-light);
  border-radius: 10px;
  padding: 0.55rem 0.8rem;
  background: #0f172a;
  color: var(--text-primary);
  font-size: 0.86rem;
  cursor: pointer;
  text-decoration: none;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}
.btn.primary { background: var(--accent-dim); border-color: var(--accent); }
.btn.success { background: var(--green-dim); border-color: var(--green); }
.btn.danger { background: var(--red-dim); border-color: var(--red); }
.btn:disabled { opacity: 0.55; cursor: not-allowed; }

.link-list { display: flex; flex-wrap: wrap; gap: 0.5rem; margin-top: 0.6rem; }
.todo-list { padding-left: 1.1rem; margin-top: 0.5rem; }
.todo-list li { margin-bottom: 0.42rem; }
.time-item { margin-bottom: 0.5rem; }
.time-item b { color: var(--accent); }
.muted { color: var(--text-secondary); }
.hero {
  margin: 1rem;
  padding: 1rem;
  border-radius: var(--radius);
  border: 1px solid var(--border);
  background: linear-gradient(160deg, rgba(34,211,238,0.1), rgba(17,24,39,0.9));
}
.hero-wrap { display: grid; grid-template-columns: 88px 1fr; gap: 0.9rem; align-items: center; }
.hero-photo {
  width: 88px;
  height: 88px;
  border-radius: 50%;
  border: 2px solid var(--accent);
  object-fit: cover;
  background: #0b1220;
}
.hero-count { font-family: var(--font-mono); font-size: 0.9rem; color: var(--accent); margin-top: 0.25rem; }
.quiz-title { font-weight: 600; margin-bottom: 0.45rem; color: var(--text-primary); }
.quiz-option {
  display: block;
  width: 100%;
  margin-bottom: 0.45rem;
  text-align: left;
}
.quiz-meta { font-size: 0.78rem; color: var(--text-muted); margin-bottom: 0.5rem; }
.theme-chip { font-size: 0.78rem; padding: 0.4rem 0.65rem; border-radius: 999px; border: 1px solid var(--border-light); cursor: pointer; }
.theme-chip.active { border-color: var(--accent); color: var(--accent); box-shadow: 0 0 0 1px var(--accent-dim) inset; }
.party-layer { position: fixed; inset: 0; pointer-events: none; overflow: hidden; z-index: 3; }
.balloon {
  position: absolute;
  bottom: -120px;
  width: 24px;
  height: 30px;
  border-radius: 50% 50% 48% 48%;
  opacity: 0.65;
  animation: balloonRise linear infinite;
}
.balloon::after {
  content: '';
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  top: 28px;
  width: 1px;
  height: 44px;
  background: rgba(255,255,255,0.18);
}
.glitter {
  position: absolute;
  width: 4px;
  height: 4px;
  border-radius: 50%;
  background: rgba(255,255,255,0.75);
  animation: glitterTwinkle 3.8s ease-in-out infinite;
}
@keyframes balloonRise {
  from { transform: translateY(0) translateX(0) rotate(0deg); }
  to { transform: translateY(-120vh) translateX(28px) rotate(12deg); }
}
@keyframes glitterTwinkle {
  0%,100% { opacity: 0.15; transform: scale(0.6); }
  50% { opacity: 0.85; transform: scale(1.2); }
}
.flip-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 0.6rem; }
.flip-card { perspective: 900px; min-height: 120px; }
.flip-inner {
  position: relative;
  width: 100%;
  min-height: 120px;
  transform-style: preserve-3d;
  transition: transform 0.55s ease;
}
.flip-card.flipped .flip-inner { transform: rotateY(180deg); }
.flip-face {
  position: absolute;
  inset: 0;
  border-radius: 10px;
  border: 1px solid var(--border-light);
  background: rgba(10,14,23,0.75);
  padding: 0.7rem;
  backface-visibility: hidden;
}
.flip-face.back { transform: rotateY(180deg); background: var(--accent-dim); }
.photo-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 0.55rem; margin-top: 0.7rem; }
.photo-item { border-radius: 10px; overflow: hidden; border: 1px solid var(--border-light); background: rgba(10,14,23,0.7); }
.photo-item img { width: 100%; height: 110px; object-fit: cover; display: block; }
.photo-item div { padding: 0.4rem 0.5rem; font-size: 0.75rem; color: var(--text-secondary); }
.bottom-nav {
  position: fixed;
  left: 50%;
  bottom: max(8px, env(safe-area-inset-bottom));
  transform: translateX(-50%);
  background: rgba(12,18,32,0.88);
  border: 1px solid var(--border-light);
  border-radius: 999px;
  padding: 0.35rem;
  display: flex;
  gap: 0.28rem;
  z-index: 25;
  backdrop-filter: blur(8px);
}
.nav-chip {
  border: 1px solid transparent;
  border-radius: 999px;
  padding: 0.33rem 0.56rem;
  font-size: 0.72rem;
  color: var(--text-secondary);
  background: transparent;
  cursor: pointer;
}
.nav-chip:hover { border-color: var(--border-light); color: var(--text-primary); }
</style>
</head>
<body>
<div class="party-layer" aria-hidden="true">
  <div class="balloon" style="left:8%;background:#22d3ee;animation-duration:16s;"></div>
  <div class="balloon" style="left:18%;background:#34d399;animation-duration:20s;"></div>
  <div class="balloon" style="left:34%;background:#a78bfa;animation-duration:18s;"></div>
  <div class="balloon" style="left:56%;background:#fbbf24;animation-duration:17s;"></div>
  <div class="balloon" style="left:76%;background:#f87171;animation-duration:21s;"></div>
  <div class="balloon" style="left:90%;background:#f472b6;animation-duration:19s;"></div>
  <div class="glitter" style="left:9%;top:14%;animation-delay:0.2s;"></div>
  <div class="glitter" style="left:28%;top:36%;animation-delay:1.1s;"></div>
  <div class="glitter" style="left:47%;top:21%;animation-delay:0.7s;"></div>
  <div class="glitter" style="left:67%;top:31%;animation-delay:1.6s;"></div>
  <div class="glitter" style="left:82%;top:18%;animation-delay:0.4s;"></div>
</div>

<div class="desktop-wrapper">
  <div class="desktop-story">
    <div class="eyebrow">2076 PARTY APP</div>
    <h1>It&apos;s My Birthday <span class="highlight">Omar 50</span></h1>
    <p>
      Mobile-first party planner for June 19, 2026. The visuals stay exactly in the original app-shell style,
      with sections for RSVP, links, directions, and the Omar 50 timeline inspired by B√≥k L√≠fsins and omar4.0.
    </p>
  </div>

  <div class="phone-wrapper">
    <div class="phone-frame">
      <div class="phone-content" id="phoneContent"></div>
    </div>
  </div>

  <div class="desktop-right"></div>
</div>

<div class="phone-content-mobile" id="appContent">
  <header class="safe-top" style="background: var(--bg-card); border-bottom: 1px solid var(--border); padding: 1rem 1.25rem;">
    <div class="section-label" data-i18n="mobile_hub">MOBILE EVENT HUB</div>
    <h1 style="font-size: 1.5rem; font-weight: 700;" data-i18n="title">It&apos;s My Birthday</h1>
    <p class="muted" style="margin-top:0.35rem; font-size:0.9rem;" data-i18n="subtitle">Party planner and RSVP flow for Omar&apos;s 50th.</p>
    <div style="margin-top:0.5rem;">
      <span class="theme-chip active" data-lang-select="is">IS</span>
      <span class="theme-chip" data-lang-select="en">EN</span>
    </div>
  </header>

  <section id="sec-home" class="hero animate-on-scroll">
    <div class="hero-wrap">
      <img class="hero-photo" src="/omar-birthday.jpg" alt="Birthday person photo" />
      <div>
        <div style="font-weight:700; font-size:1.1rem;">Omar turns 50</div>
        <div class="muted" style="font-size:0.86rem; margin-top:0.1rem;">19 June 2026</div>
        <div class="hero-count" data-countdown>Loading countdown...</div>
      </div>
    </div>
    <div style="margin-top:0.7rem;">
      <span class="theme-chip active" data-theme-select="neon">Neon</span>
      <span class="theme-chip" data-theme-select="disco">Disco</span>
      <span class="theme-chip" data-theme-select="sunset">Sunset</span>
    </div>
  </section>

  <section style="padding: 0 1rem 1rem;">
    <div class="section-label" data-i18n="party_sections">PARTY SECTIONS</div>

    <div id="sec-rsvp" class="card expand-card animate-on-scroll open" onclick="this.classList.toggle('open')" style="margin-bottom: 0.75rem;">
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <div>
          <div style="font-weight: 600;" data-i18n="rsvp_title">Svara bo√∞i + innskr√°ning</div>
          <div style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 0.25rem;" data-i18n="rsvp_sub">Skr√°√∞u √æig inn me√∞ SMS e√∞a Google og svara√∞u bo√∞inu</div>
        </div>
        <span class="expand-indicator" style="color: var(--text-muted);">‚ñº</span>
      </div>
      <div class="expand-content">
        <div style="padding-top: 1rem; font-size: 0.9rem; color: var(--text-secondary); line-height: 1.6;">
          <div class="link-list" style="margin-top:0; margin-bottom:0.7rem;">
            <button class="btn" data-auth="sms" data-i18n="auth_sms">Halda √°fram me√∞ SMS</button>
            <button class="btn" data-auth="google" data-i18n="auth_google">Halda √°fram me√∞ Google</button>
          </div>
          <div data-auth-state class="muted" style="font-size:0.82rem;" data-i18n="not_signed">Ekki innskr√°√∞/ur.</div>
          <div class="link-list" style="margin-top:0.7rem;">
            <button class="btn success" data-rsvp="yes" data-i18n="yes_btn" disabled>Yes, I&apos;ll attend</button>
            <button class="btn danger" data-rsvp="no" data-i18n="no_btn" disabled>No, can&apos;t make it</button>
          </div>
          <div data-status class="muted" style="margin-top:0.6rem; font-size:0.82rem;" data-i18n="sign_in_first">Skr√°√∞u √æig inn fyrst til a√∞ svara bo√∞inu.</div>
        </div>
      </div>
    </div>

    <div id="sec-links" class="card expand-card animate-on-scroll" onclick="this.classList.toggle('open')" style="margin-bottom: 0.75rem;">
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <div>
          <div style="font-weight: 600;">Links, Directions, and To-Do</div>
          <div style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 0.25rem;">Everything guests need before party day</div>
        </div>
        <span class="expand-indicator" style="color: var(--text-muted);">‚ñº</span>
      </div>
      <div class="expand-content">
        <div style="padding-top: 1rem; font-size: 0.9rem; color: var(--text-secondary); line-height: 1.6;">
          <div class="link-list">
            <a class="btn primary" href="https://facebook.com/events" target="_blank" rel="noreferrer">Facebook Event</a>
            <a class="btn" href="https://maps.google.com/?q=Reykjav%C3%ADk" target="_blank" rel="noreferrer">Directions</a>
          </div>
          <div style="margin-top:0.8rem;" class="muted">
            <div class="time-item"><b>18:00</b> Doors open + welcome drinks</div>
            <div class="time-item"><b>19:30</b> Story highlights + toasts</div>
            <div class="time-item"><b>21:00</b> Music + dance floor</div>
          </div>
          <ul class="todo-list">
            <li>Confirm exact venue address and parking notes.</li>
            <li>Finalize food + cake count from RSVP totals.</li>
            <li>Publish final guest note 72 hours before event.</li>
          </ul>
          <span class="pill">Mobile only</span>
          <span class="pill">2076 style</span>
        </div>
      </div>
    </div>

    <div class="card expand-card animate-on-scroll" onclick="this.classList.toggle('open')" style="margin-bottom: 0.75rem;">
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <div>
          <div style="font-weight: 600;">Flj√≥tlegar sta√∞reyndir</div>
          <div style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 0.25rem;">Smelltu til a√∞ sn√∫a</div>
        </div>
        <span class="expand-indicator" style="color: var(--text-muted);">‚ñº</span>
      </div>
      <div class="expand-content">
        <div style="padding-top: 1rem;">
          <div class="flip-grid">
            <div class="flip-card" data-flip-card>
              <div class="flip-inner">
                <div class="flip-face front">1999<br><small class="muted">Career plot twist</small></div>
                <div class="flip-face back">One T√∂lvun phone call rerouted everything. Hiring by destiny, not by HR portal.</div>
              </div>
            </div>
            <div class="flip-card" data-flip-card>
              <div class="flip-inner">
                <div class="flip-face front">2017<br><small class="muted">omar4.0 launched</small></div>
                <div class="flip-face back">Yearly upgrades started. Turns out people can ship changelogs too.</div>
              </div>
            </div>
            <div class="flip-card" data-flip-card>
              <div class="flip-inner">
                <div class="flip-face front">2026<br><small class="muted">v50.0 celebration</small></div>
                <div class="flip-face back">No rollback plan. Party hardening is in production.</div>
              </div>
            </div>
            <div class="flip-card" data-flip-card>
              <div class="flip-inner">
                <div class="flip-face front">Budapest<br><small class="muted">legend mode</small></div>
                <div class="flip-face back">40 beers, 4 days, and somehow still enough memory for this party.</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="sec-quiz" class="card expand-card animate-on-scroll" onclick="this.classList.toggle('open')" style="margin-bottom: 0.75rem;">
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <div>
          <div style="font-weight: 600;">Omar 50 Story Markers</div>
          <div style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 0.25rem;">Pulled from the existing 50-year Omar material</div>
        </div>
        <span class="expand-indicator" style="color: var(--text-muted);">‚ñº</span>
      </div>
      <div class="expand-content">
        <div style="padding-top: 1rem; font-size: 0.9rem; color: var(--text-secondary); line-height: 1.6;">
          <div class="time-item"><b>1999</b> The T√∂lvun call changed career direction.</div>
          <div class="time-item"><b>2017</b> omar4.0 began yearly intentional upgrades.</div>
          <div class="time-item"><b>2026</b> v50.0 celebration: people, gratitude, and memories.</div>
        </div>
      </div>
    </div>

    <div class="card expand-card animate-on-scroll" onclick="this.classList.toggle('open')" style="margin-bottom: 0.75rem;">
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <div>
          <div style="font-weight: 600;">Omar 50 Quiz</div>
          <div style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 0.25rem;">All questions loaded from extracted quiz database</div>
        </div>
        <span class="expand-indicator" style="color: var(--text-muted);">‚ñº</span>
      </div>
      <div class="expand-content">
        <div style="padding-top: 1rem; font-size: 0.9rem; color: var(--text-secondary); line-height: 1.6;">
          <div class="quiz-meta">
            <span data-quiz-progress>Spurning 0 / 0</span> ‚Ä¢ <span data-quiz-score>Stig 0</span>
          </div>
          <div data-quiz-question class="quiz-title">√ùttu √° ‚ÄûByrja leik‚Äú til a√∞ hefja.</div>
          <div data-quiz-options></div>
          <div data-quiz-result class="muted" style="margin-top:0.45rem; min-height: 1.6rem;"></div>
          <div class="link-list" style="margin-top:0.6rem;">
            <button class="btn primary" data-quiz-action="start">Byrja leik</button>
            <button class="btn" data-quiz-action="next" disabled>N√¶sta spurning</button>
          </div>
          <div class="link-list" style="margin-top:0.6rem;">
            <button class="btn" data-quiz-admin="login">Opna stj√≥rnandaa√∞gang</button>
            <button class="btn" data-quiz-admin="add" disabled>B√¶ta vi√∞ spurningu</button>
            <button class="btn danger" data-quiz-admin="delete" disabled>Ey√∞a spurningu</button>
          </div>
        </div>
      </div>
    </div>

    <div id="sec-hosting" class="card expand-card animate-on-scroll" onclick="this.classList.toggle('open')" style="margin-bottom: 0.75rem;">
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <div>
          <div style="font-weight: 600;">Hosting Slug + Hashtag</div>
          <div style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 0.25rem;">`mybirthday.myx.is/omars50` and hashtag-aware routing.</div>
        </div>
        <span class="expand-indicator" style="color: var(--text-muted);">‚ñº</span>
      </div>
      <div class="expand-content">
        <div style="padding-top: 1rem;">
          <div class="muted">Current slug: <b data-current-slug>omars50</b></div>
          <div class="muted" style="margin-top:0.2rem;">Instagram hashtag: <a data-hashtag-link href="#" target="_blank" class="btn" style="padding:0.25rem 0.45rem;">#omars50</a></div>
          <div class="link-list" style="margin-top:0.6rem;">
            <button class="btn" data-hosting-action="signup">Create New Hosted Party</button>
          </div>
        </div>
      </div>
    </div>

    <div id="sec-photo" class="card expand-card animate-on-scroll" onclick="this.classList.toggle('open')" style="margin-bottom: 0.75rem;">
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <div>
          <div style="font-weight: 600;">Photo Wall</div>
          <div style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 0.25rem;">Instagram hashtag wall + host-curated photos.</div>
        </div>
        <span class="expand-indicator" style="color: var(--text-muted);">‚ñº</span>
      </div>
      <div class="expand-content">
        <div style="padding-top: 1rem;">
          <div class="link-list" style="margin-top:0;">
            <a class="btn primary" data-instagram-tag target="_blank" rel="noreferrer">Open Instagram Tag</a>
            <button class="btn" data-photo-action="add" disabled>Add Photo (Host)</button>
          </div>
          <div data-photo-status class="muted" style="margin-top:0.5rem;">Loading photowall...</div>
          <div class="photo-grid" data-photo-grid></div>
        </div>
      </div>
    </div>

    <div id="sec-host" class="card expand-card animate-on-scroll" onclick="this.classList.toggle('open')" style="margin-bottom: 0.75rem;">
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <div>
          <div style="font-weight: 600;">Stj√≥rnbor√∞ gestgjafa</div>
          <div style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 0.25rem;">Attendees overview, quiz analytics, and recent answers.</div>
        </div>
        <span class="expand-indicator" style="color: var(--text-muted);">‚ñº</span>
      </div>
      <div class="expand-content">
        <div style="padding-top: 1rem;">
          <div class="link-list" style="margin-top:0;">
            <button class="btn" data-admin-action="login">Innskr√°ning gestgjafa</button>
            <button class="btn primary" data-admin-action="refresh" disabled>Uppf√¶ra yfirlit</button>
          </div>
          <div data-admin-status class="muted" style="margin-top:0.5rem;">Gestgjafahamur er l√¶stur.</div>
          <div data-admin-overview class="muted" style="margin-top:0.7rem; font-size:0.86rem;"></div>
        </div>
      </div>
    </div>
  </section>

  <section style="padding: 0 1rem 1rem; display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem;">
    <div class="kpi">
      <div class="kpi-label">Event Date</div>
      <div class="kpi-value" style="color: var(--accent);">19 JUN</div>
    </div>
    <div class="kpi">
      <div class="kpi-label">Location</div>
      <div class="kpi-value" style="color: var(--green);">Reykjavik</div>
    </div>
    <div class="kpi">
      <div class="kpi-label">Attending</div>
      <div class="kpi-value" style="color: var(--amber);" data-yes-count>0</div>
    </div>
    <div class="kpi">
      <div class="kpi-label">Not Attending</div>
      <div class="kpi-value" style="color: var(--purple);" data-no-count>0</div>
    </div>
  </section>

  <footer class="safe-bottom" style="text-align: center; padding: 2rem 1rem; color: var(--text-muted); font-size: 0.8rem;">
    It&apos;s My Birthday ‚Ä¢ Omar 50 ‚Ä¢ 19 June 2026
  </footer>

  <nav class="bottom-nav">
    <button class="nav-chip" data-jump="sec-home" data-i18n="nav_home">Heim</button>
    <button class="nav-chip" data-jump="sec-rsvp" data-i18n="nav_rsvp">RSVP</button>
    <button class="nav-chip" data-jump="sec-links" data-i18n="nav_plan">Dagskr√°</button>
    <button class="nav-chip" data-jump="sec-quiz" data-i18n="nav_quiz">Spurningar</button>
    <button class="nav-chip" data-jump="sec-photo" data-i18n="nav_photos">Myndir</button>
    <button class="nav-chip" data-jump="sec-host" data-i18n="nav_host">Gestgjafi</button>
  </nav>
</div>

<script>
function initInteractions(root) {
  const state = { method: null, contact: null, name: null };
  const quizState = { questions: [], index: -1, score: 0, active: false, adminPassword: null };

  const authState = root.querySelector('[data-auth-state]');
  const statusEl = root.querySelector('[data-status]');
  const yesBtn = root.querySelector('[data-rsvp="yes"]');
  const noBtn = root.querySelector('[data-rsvp="no"]');
  const quizProgress = root.querySelector('[data-quiz-progress]');
  const quizScore = root.querySelector('[data-quiz-score]');
  const quizQuestion = root.querySelector('[data-quiz-question]');
  const quizOptions = root.querySelector('[data-quiz-options]');
  const quizResult = root.querySelector('[data-quiz-result]');
  const quizStartBtn = root.querySelector('[data-quiz-action="start"]');
  const quizNextBtn = root.querySelector('[data-quiz-action="next"]');
  const quizAdminLoginBtn = root.querySelector('[data-quiz-admin="login"]');
  const quizAdminAddBtn = root.querySelector('[data-quiz-admin="add"]');
  const quizAdminDeleteBtn = root.querySelector('[data-quiz-admin="delete"]');
  const adminStatus = root.querySelector('[data-admin-status]');
  const adminOverview = root.querySelector('[data-admin-overview]');
  const adminLoginBtn = root.querySelector('[data-admin-action="login"]');
  const adminRefreshBtn = root.querySelector('[data-admin-action="refresh"]');
  const currentSlugLabel = root.querySelector('[data-current-slug]');
  const hashtagLink = root.querySelector('[data-hashtag-link]');
  const instagramTagLink = root.querySelector('[data-instagram-tag]');
  const hostingSignupBtn = root.querySelector('[data-hosting-action="signup"]');
  const photoStatus = root.querySelector('[data-photo-status]');
  const photoGrid = root.querySelector('[data-photo-grid]');
  const photoAddBtn = root.querySelector('[data-photo-action="add"]');
  const currentSlug = (window.__APP_SLUG__ || location.pathname.split('/').filter(Boolean)[0] || 'omars50').toLowerCase();

  root.querySelectorAll('button, a.btn').forEach((el) => {
    el.addEventListener('click', (ev) => ev.stopPropagation());
  });
  root.querySelectorAll('[data-flip-card]').forEach((el) => {
    el.addEventListener('click', (ev) => {
      ev.stopPropagation();
      el.classList.toggle('flipped');
    });
  });
  root.querySelectorAll('[data-jump]').forEach((el) => {
    el.addEventListener('click', (ev) => {
      ev.stopPropagation();
      const id = el.getAttribute('data-jump');
      if (!id) return;
      const target = root.querySelector('#' + id);
      if (!target) return;
      if (root.id === 'phoneContent') {
        root.scrollTo({ top: target.offsetTop - 10, behavior: 'smooth' });
      } else {
        target.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
    });
  });

  if (currentSlugLabel) currentSlugLabel.textContent = currentSlug;

  function setSignedIn(method, contact, name) {
    state.method = method;
    state.contact = contact;
    state.name = name;
    authState.textContent = 'Signed in via ' + method.toUpperCase() + ' as ' + contact;
    yesBtn.disabled = false;
    noBtn.disabled = false;
    statusEl.textContent = 'Tilb√∫i√∞ a√∞ svara bo√∞i.';
  }

  async function refreshStats() {
    try {
      const res = await fetch('/api/rsvp/stats');
      const data = await res.json();
      document.querySelectorAll('[data-yes-count]').forEach((el) => { el.textContent = String(data.attendingYes ?? 0); });
      document.querySelectorAll('[data-no-count]').forEach((el) => { el.textContent = String(data.attendingNo ?? 0); });
    } catch {
      document.querySelectorAll('[data-yes-count]').forEach((el) => { el.textContent = '?'; });
      document.querySelectorAll('[data-no-count]').forEach((el) => { el.textContent = '?'; });
    }
  }

  async function submitRsvp(attending) {
    if (!state.contact || !state.method) {
      statusEl.textContent = 'Please sign in first.';
      return;
    }

    const partySize = Number(prompt('How many in your party including you?', '1') || '1');
    const plusOne = prompt('Plus-one name (optional):', '') || '';
    const dietary = prompt('Dietary notes (optional):', '') || '';
    const note = prompt('Message for Omar (optional):', '') || '';

    statusEl.textContent = 'Submitting RSVP...';
    try {
      const res = await fetch('/api/rsvp', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          attending,
          method: state.method,
          contact: state.contact,
          name: state.name || 'Guest',
          partySize: Number.isFinite(partySize) ? partySize : 1,
          plusOne,
          dietary,
          note,
        })
      });
      const data = await res.json();
      if (!res.ok) throw new Error(data.error || 'Failed to RSVP');
      statusEl.textContent = attending
        ? 'Bo√∞ssvar vista√∞: m√¶tir.'
        : 'Bo√∞ssvar vista√∞: kemst ekki.';
      await refreshStats();
    } catch (err) {
      statusEl.textContent = 'Error: ' + err.message;
    }
  }

  function renderQuizQuestion() {
    const q = quizState.questions[quizState.index];
    if (!q) return;
    quizProgress.textContent = 'Spurning ' + (quizState.index + 1) + ' / ' + quizState.questions.length;
    quizScore.textContent = 'Stig ' + quizState.score;
    quizQuestion.textContent = q.cat + ' (' + q.yr + '): ' + q.q;
    quizResult.textContent = '';
    quizOptions.innerHTML = '';
    q.opts.forEach((opt, idx) => {
      const btn = document.createElement('button');
      btn.className = 'btn quiz-option';
      btn.type = 'button';
      btn.textContent = String.fromCharCode(65 + idx) + '. ' + opt;
      btn.addEventListener('click', async (ev) => {
        ev.stopPropagation();
        if (!quizState.active) return;
        quizState.active = false;
        const res = await fetch('/api/quiz/answer', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            id: q.id,
            choice: idx,
            playerId: state.contact || 'anon',
            playerName: state.name || 'Guest',
          })
        });
        const data = await res.json();
        if (data.correct) {
          quizState.score += 1;
          quizResult.textContent = 'R√©tt svar! ' + data.explanation;
        } else {
          quizResult.textContent = 'Rangt svar. ' + data.explanation;
        }
        quizScore.textContent = 'Score ' + quizState.score;
        quizNextBtn.disabled = false;
        Array.from(quizOptions.querySelectorAll('button')).forEach((b) => { b.disabled = true; });
      });
      quizOptions.appendChild(btn);
    });
  }

  async function startQuiz(ev) {
    ev.stopPropagation();
    quizStartBtn.disabled = true;
    quizResult.textContent = 'Hle√∞ inn spurningum...';
    try {
      const res = await fetch('/api/quiz/questions');
      const data = await res.json();
      quizState.questions = data.questions || [];
      quizState.index = 0;
      quizState.score = 0;
      quizState.active = true;
      quizNextBtn.disabled = true;
      renderQuizQuestion();
    } catch {
      quizResult.textContent = 'Could not load quiz.';
    } finally {
      quizStartBtn.disabled = false;
    }
  }

  function nextQuizQuestion(ev) {
    ev.stopPropagation();
    if (!quizState.questions.length) return;
    quizState.index += 1;
    if (quizState.index >= quizState.questions.length) {
      quizQuestion.textContent = 'Leik loki√∞.';
      quizOptions.innerHTML = '';
      quizResult.textContent = 'Lokastig: ' + quizState.score + ' / ' + quizState.questions.length;
      quizProgress.textContent = 'Spurning ' + quizState.questions.length + ' / ' + quizState.questions.length;
      quizNextBtn.disabled = true;
      quizState.active = false;
      return;
    }
    quizState.active = true;
    quizNextBtn.disabled = true;
    renderQuizQuestion();
  }

  function adminHeaders() {
    return {
      'Content-Type': 'application/json',
      'x-admin-password': quizState.adminPassword || ''
    };
  }

  function adminLogin(ev) {
    ev.stopPropagation();
    const pass = prompt('Admin password:');
    if (!pass) return;
    quizState.adminPassword = pass;
    quizAdminAddBtn.disabled = false;
    quizAdminDeleteBtn.disabled = false;
    if (adminRefreshBtn) adminRefreshBtn.disabled = false;
    quizResult.textContent = 'Stj√≥rnandahamur virkur.';
    if (adminStatus) adminStatus.textContent = 'Gestgjafahamur virkur.';
  }

  async function refreshAdminOverview(ev) {
    if (ev) ev.stopPropagation();
    if (!quizState.adminPassword || !adminOverview || !adminStatus) return;
    adminStatus.textContent = 'Hle√∞ yfirliti gestgjafa...';
    try {
      const res = await fetch('/api/admin/overview', { headers: { 'x-admin-password': quizState.adminPassword } });
      const data = await res.json();
      if (!res.ok) throw new Error(data.error || 'Failed to load overview');
      const attendees = data.attendees || {};
      const quiz = data.quiz || {};
      const recent = (quiz.recentAnswers || []).slice(0, 8).map((r) =>
        (r.playerName || 'Guest') + ' -> Q' + r.questionId + ' ' + (r.correct ? '‚úÖ' : '‚ùå')
      );
      adminOverview.innerHTML = [
        '<b>Attendees:</b> ' + (attendees.attending ?? 0) + ' yes, ' + (attendees.notAttending ?? 0) + ' no, heads: ' + (attendees.totalHeads ?? 0),
        '<br><b>Part√Ωsta√∞a:</b> ' + (attendees.humor || 'Dansg√≥lf √≥sta√∞fest.'),
        '<br><b>Quiz:</b> ' + (quiz.totalAnswers ?? 0) + ' answers, accuracy ' + Math.round((quiz.overallAccuracy || 0) * 100) + '%',
        '<br><b>Erfi√∞asta spurning:</b> ' + (quiz.hardestQuestionId ?? 'n/a'),
        '<br><b>Recent answers:</b> ' + (recent.length ? recent.join(' ‚Ä¢ ') : 'None yet')
      ].join('');
      adminStatus.textContent = 'Yfirlit gestgjafa uppf√¶rt.';
    } catch (err) {
      adminStatus.textContent = 'Mist√≥kst a√∞ s√¶kja yfirlit gestgjafa: ' + err.message;
    }
  }

  function updateHashtagLinks(tag) {
    const clean = (tag || currentSlug).replace(/^#/, '');
    const url = 'https://www.instagram.com/explore/tags/' + encodeURIComponent(clean) + '/';
    if (hashtagLink) {
      hashtagLink.textContent = '#' + clean;
      hashtagLink.setAttribute('href', url);
    }
    if (instagramTagLink) instagramTagLink.setAttribute('href', url);
  }

  async function loadPhotoWall() {
    if (!photoGrid || !photoStatus) return;
    photoStatus.textContent = 'Hle√∞ inn myndavegg...';
    try {
      const res = await fetch('/api/photowall?slug=' + encodeURIComponent(currentSlug));
      const data = await res.json();
      if (!res.ok) throw new Error(data.error || 'Mist√≥kst a√∞ hla√∞a myndavegg');
      updateHashtagLinks(data.hashtag || currentSlug);
      const items = data.items || [];
      if (!items.length) {
        photoGrid.innerHTML = '';
        photoStatus.textContent = 'Engar myndir enn. B√¶ttu vi√∞ √≠ gestgjafaham e√∞a nota√∞u #' + (data.hashtag || currentSlug);
        return;
      }
      photoStatus.textContent = items.length + ' myndir s√≥ttar.';
      photoGrid.innerHTML = items.slice(0, 24).map((item) => (
        '<div class="photo-item">' +
          '<img src="' + item.imageUrl + '" alt="Mynd √° myndavegg" loading="lazy" />' +
          '<div>' + (item.caption || 'Part√Ωminning') + '</div>' +
        '</div>'
      )).join('');
    } catch (err) {
      photoStatus.textContent = 'Myndaveggur br√°st: ' + err.message;
    }
  }

  async function hostingSignup(ev) {
    ev.stopPropagation();
    const hashtag = prompt('Hashtag fyrir sl√≥√∞ (d√¶mi: #omars50):', '#' + currentSlug);
    if (!hashtag) return;
    const instagramHandle = prompt('Instagram notandi (valfrj√°lst, √°n @):', '');
    const title = prompt('Heiti vi√∞bur√∞ar:', "It's My Birthday");
    const owner = prompt('Eigandi (valfrj√°lst):', '');
    try {
      const res = await fetch('/api/hosting/signup', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ hashtag, instagramHandle, title, owner })
      });
      const data = await res.json();
      if (!res.ok) throw new Error(data.error || 'Mist√≥kst a√∞ b√∫a til h√Ωsingu');
      alert('N√Ω part√Ωs√≠√∞a b√∫in til: ' + data.url + '\\nHashtag: #' + data.tenant.hashtag);
    } catch (err) {
      alert('H√Ωsing mist√≥kst: ' + err.message);
    }
  }

  async function addPhotoItem(ev) {
    ev.stopPropagation();
    if (!quizState.adminPassword) return;
    const imageUrl = prompt('Sl√≥√∞ √° mynd:');
    if (!imageUrl) return;
    const caption = prompt('Texti (valfrj√°lst):', '') || '';
    const sourceUrl = prompt('Instagram/sl√≥√∞ uppruna (valfrj√°lst):', '') || '';
    try {
      const res = await fetch('/api/photowall/item', {
        method: 'POST',
        headers: adminHeaders(),
        body: JSON.stringify({ slug: currentSlug, imageUrl, caption, sourceUrl })
      });
      const data = await res.json();
      if (!res.ok) throw new Error(data.error || 'Mist√≥kst a√∞ b√¶ta vi√∞ mynd');
      if (photoStatus) photoStatus.textContent = 'Mynd b√¶tt vi√∞.';
      await loadPhotoWall();
    } catch (err) {
      if (photoStatus) photoStatus.textContent = 'Mynd mist√≥kst: ' + err.message;
    }
  }

  async function adminAddQuestion(ev) {
    ev.stopPropagation();
    if (!quizState.adminPassword) return;
    const yr = Number(prompt('Year (e.g. 2026):', '2026'));
    const cat = prompt('Category (e.g. üéâ Party):', 'üéâ Party');
    const q = prompt('Question text:');
    const optsInput = prompt('Options separated by | (example: A|B|C|D):');
    const ans = Number(prompt('Correct option index (0-based):', '0'));
    const exp = prompt('Explanation (optional):', 'Added by admin.');
    const fun = prompt('Fun fact (optional):', 'Custom question');
    if (!Number.isInteger(yr) || !cat || !q || !optsInput || !Number.isInteger(ans)) {
      quizResult.textContent = 'Admin add cancelled or invalid input.';
      return;
    }
    const opts = optsInput.split('|').map((x) => x.trim()).filter(Boolean);
    if (opts.length < 2) {
      quizResult.textContent = 'Need at least 2 options.';
      return;
    }
    try {
      const res = await fetch('/api/quiz/admin/question', {
        method: 'POST',
        headers: adminHeaders(),
        body: JSON.stringify({ yr, cat, q, opts, ans, exp, fun })
      });
      const data = await res.json();
      if (!res.ok) throw new Error(data.error || 'Failed to add question');
      quizResult.textContent = 'Question added with id ' + data.question.id + '.';
    } catch (err) {
      quizResult.textContent = 'Admin add failed: ' + err.message;
    }
  }

  async function adminDeleteQuestion(ev) {
    ev.stopPropagation();
    if (!quizState.adminPassword) return;
    const id = Number(prompt('Question id to delete (admin-added only):'));
    if (!Number.isInteger(id)) return;
    try {
      const res = await fetch('/api/quiz/admin/question?id=' + encodeURIComponent(String(id)), {
        method: 'DELETE',
        headers: { 'x-admin-password': quizState.adminPassword }
      });
      const data = await res.json();
      if (!res.ok) throw new Error(data.error || 'Failed to delete question');
      quizResult.textContent = 'Deleted question ' + data.id + '.';
    } catch (err) {
      quizResult.textContent = 'Delete failed: ' + err.message;
    }
  }

  const smsBtn = root.querySelector('[data-auth="sms"]');
  const googleBtn = root.querySelector('[data-auth="google"]');
  smsBtn.addEventListener('click', () => {
    const phone = prompt('Enter your phone number (for SMS sign-in):');
    if (!phone) return;
    const name = prompt('Your name:') || 'Guest';
    setSignedIn('sms', phone.trim(), name.trim());
  });
  googleBtn.addEventListener('click', () => {
    const email = prompt('Enter your Google email:');
    if (!email) return;
    const name = prompt('Your name:') || 'Guest';
    setSignedIn('google', email.trim().toLowerCase(), name.trim());
  });

  yesBtn.addEventListener('click', () => submitRsvp(true));
  noBtn.addEventListener('click', () => submitRsvp(false));
  if (quizStartBtn) quizStartBtn.addEventListener('click', startQuiz);
  if (quizNextBtn) quizNextBtn.addEventListener('click', nextQuizQuestion);
  if (quizAdminLoginBtn) quizAdminLoginBtn.addEventListener('click', adminLogin);
  if (quizAdminAddBtn) quizAdminAddBtn.addEventListener('click', adminAddQuestion);
  if (quizAdminDeleteBtn) quizAdminDeleteBtn.addEventListener('click', adminDeleteQuestion);
  if (adminLoginBtn) adminLoginBtn.addEventListener('click', adminLogin);
  if (adminRefreshBtn) adminRefreshBtn.addEventListener('click', refreshAdminOverview);

  refreshStats();
}

function initThemeSelector() {
  const root = document.documentElement;
  const saved = localStorage.getItem('party-theme') || 'neon';
  function apply(name) {
    if (name === 'neon') root.removeAttribute('data-theme');
    else root.setAttribute('data-theme', name);
    localStorage.setItem('party-theme', name);
    document.querySelectorAll('[data-theme-select]').forEach((el) => {
      el.classList.toggle('active', el.getAttribute('data-theme-select') === name);
    });
  }
  apply(saved);
  document.querySelectorAll('[data-theme-select]').forEach((el) => {
    el.addEventListener('click', () => apply(el.getAttribute('data-theme-select')));
  });
}

function startCountdown() {
  const target = new Date('2026-06-19T00:00:00');
  function tick() {
    const now = new Date();
    const diff = target.getTime() - now.getTime();
    const nodes = document.querySelectorAll('[data-countdown]');
    if (diff <= 0) {
      nodes.forEach((n) => { n.textContent = 'Happy Birthday!'; });
      return;
    }
    const d = Math.floor(diff / 86400000);
    const h = Math.floor((diff % 86400000) / 3600000);
    const m = Math.floor((diff % 3600000) / 60000);
    const s = Math.floor((diff % 60000) / 1000);
    const text = d + 'd ' + h + 'h ' + m + 'm ' + s + 's to party';
    nodes.forEach((n) => { n.textContent = text; });
  }
  tick();
  setInterval(tick, 1000);
}

if (window.innerWidth > 768) {
  const src = document.getElementById('appContent');
  const dest = document.getElementById('phoneContent');
  if (src && dest) {
    dest.innerHTML = src.innerHTML;
    src.style.display = 'none';
    initInteractions(dest);
  }
} else {
  initInteractions(document.getElementById('appContent'));
}
startCountdown();

const observer = new IntersectionObserver((entries) => {
  entries.forEach((entry) => {
    if (entry.isIntersecting) {
      entry.target.classList.add('visible');
      observer.unobserve(entry.target);
    }
  });
}, { threshold: 0.1, rootMargin: '0px 0px -50px 0px' });

document.querySelectorAll('.animate-on-scroll').forEach((el) => observer.observe(el));

const phoneContent = document.getElementById('phoneContent');
if (phoneContent) {
  const phoneObserver = new IntersectionObserver((entries) => {
    entries.forEach((entry) => {
      if (entry.isIntersecting) {
        entry.target.classList.add('visible');
        phoneObserver.unobserve(entry.target);
      }
    });
  }, { threshold: 0.1, root: phoneContent });
  phoneContent.querySelectorAll('.animate-on-scroll').forEach((el) => phoneObserver.observe(el));
}
</script>
</body>
</html>
